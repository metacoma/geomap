<style>
div.tooltip {
    position: absolute;
    text-align: center;
    width: 60px;
    height: 28px;
    padding: 2px;
    font: 12px sans-serif;
    background: lightsteelblue;
    border: 0px;
    border-radius: 8px;
    pointer-events: none;
}
</style>

<div id="svgContainer"></div>


<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tipsy/1.0.3/jquery.tipsy.js"></script>


<script>
var sampleData = {
    "data":[
        {
            "lat": "20.593684",
            "lon": "78.9629"
        },
        {
            "lat": "51.52807562568998",
            "lon": "4.922901059462091"
        }
    ],
    "pieData": [
        [10,20,50],
        [30,60,65]
    ]
};

/*For Pie Chart*/
var pieChartInnerRadius = 15;
var pieChartOuterRadius = 0;
var pieChartData = [10,20,50];
var mapDefautFillColor = 'rgba(153, 153, 153, 0.4)', mapDefaultStrokeColor = '#333';
//mapping for markets
var indianSubContinent = [50, 64, 144, 524, 356];

// assigning svg id / svg width / svg height
var containerId = 'geoMap', width = 1000, height = 500;

// assigning projections for the map / locating / scaling the map
var projection = d3.geo.equirectangular()
    .center([0, 0])
    .scale(150)
    .rotate([0, 0]);

var svg = d3.select("#svgContainer").append("svg")
    .attr("id", containerId)
    .attr("width", width)
    .attr("height", height);

var path = d3.geo.path()
    .projection(projection);

var g = svg.append("g")
    .attr('width', width)
    .attr('height', height)

// method for plotting arc
var arc = d3.svg.arc()
    .innerRadius(pieChartInnerRadius)
    .outerRadius(pieChartOuterRadius);

// color range for pie charts defined
var pieChartColors = d3.scale.ordinal()
    .range(['#DECF3F','#5DA5DA','#F17CB0', '#B276B2']);    //yellow, blue, pink, purple

// computes the start point , end point and angle
var pie = d3.layout.pie()
    .value(function(d){return d;})

// Define the div for the tooltip
var div = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);

// color range for heat map
var colorMap = d3.scale.linear()
  .domain([0,1000])
  .range(["#EFEBE9","#3E2723"]);

// load and display the World
d3.json("https://dl.dropboxusercontent.com/s/2qg71ltlq0hc88j/readme-world-110m.json", function(error, topology) {
  // // load and display the cities
     var topo = topojson.object(topology, topology.objects.countries).geometries;

    var blocks = g.selectAll("path")
    .data(topo)
    .enter()
    .append("path")
    .attr("d", path)
    .attr("class", function(d) { return "country " + "code" + d.id; })
    .style("fill", mapDefautFillColor)
    .style("stroke", mapDefaultStrokeColor)

    // load data
    // d3.json("pieData.json", function(data) {
    var data = sampleData;
        var pieData = data.pieData;
        var data = data.data;
        console.log(pieData);

        g.selectAll('arc')
        .data(data)
        .enter()
        .append('g')
        .attr("transform", function(d) {
            var cordinates = [d.lon, d.lat];
            var p = projection(cordinates);

            return "translate("+p+")";
        })
        .selectAll('.pieChart')
        .data(pie(sampleData.pieData[0]))
        .enter()
        .append('g')
        .attr('class','arc')
        .append('path')
        .attr('d',arc)
        .attr('fill',function(d){return pieChartColors(d.value)})
    // });
});


// zoom and pan
var zoom = d3.behavior.zoom()
    .on("zoom",function() {
        g.attr("transform","translate("+
            d3.event.translate.join(",")+")scale("+d3.event.scale+")");
        // g.selectAll("circle")
        //     .attr("d", path.projection(projection));
        g.selectAll(".pieChart")
            .attr("d", path.projection(projection));
        // g.selectAll("path")
        //     .attr("d", path.projection(projection));
});

svg.call(zoom);

</script>

</html>
